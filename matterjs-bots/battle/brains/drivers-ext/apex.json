{
    "id": "apex",
    "key": false,
    "name": "Apex",
    "team": "apex",
    "brain": "var s=context.state,a=context.action,m=context.memory;\nvar PI2=Math.PI*2,PI=Math.PI;\n\nif(!m.t){m.t=0;m.lf=-99;m.ev=1;m.sw=1;}\nm.t++;\n\nvar clamp=function(v,lo,hi){return Math.max(lo,Math.min(hi,v));};\nvar angDiff=function(a,b){var d=(a-b)%PI2;if(d>PI)d-=PI2;if(d<-PI)d+=PI2;return d;};\nvar angTo=function(x1,y1,x2,y2){return Math.atan2(y2-y1,x2-x1);};\nvar dst=function(x1,y1,x2,y2){return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));};\n\nvar myX=s.position.x,myY=s.position.y,myA=s.angle;\nvar dCenter=dst(myX,myY,450,450);\nvar toCenter=s.angleToCenter;\n\n// Find closest active enemy\nvar enemy=false;\nfor(var i=0;i<s.scanner.robot.length;i++){\n  var r=s.scanner.robot[i];\n  if(r.active&&r.team!==s.team){enemy=r;break;}\n}\nvar eProj=s.scanner.projectile[0]||false;\nvar prox=s.proximity[0]||false;\n\n// Teammate collision avoidance\nvar teammate=false;\nfor(var i=0;i<s.proximity.length;i++){\n  var p=s.proximity[i];\n  if(p.entityType==='robot'&&p.range<50){\n    teammate=p;break;\n  }\n}\n\n// PRIORITY 0: Avoid teammate collisions\nif(teammate&&teammate.range<40){\n  var awayAngle=(teammate.angleFromRobot+PI)%PI2;\n  // Blend away angle with center angle\n  a.desiredAngle=awayAngle;\n  a.desiredForce=s.maxForce*0.5;\n}\n// PRIORITY 1: Dodge incoming projectiles\nelse if(eProj&&eProj.range<130){\n  var pA=eProj.angleFromRobot;\n  var incoming=(pA+PI)%PI2;\n  var pDiff=Math.abs(angDiff(eProj.angle,incoming));\n  if(pDiff<0.6){\n    var perpL=pA+PI/2;\n    var perpR=pA-PI/2;\n    var dL=Math.abs(angDiff(perpL,toCenter));\n    var dR=Math.abs(angDiff(perpR,toCenter));\n    a.desiredAngle=(dL<dR)?perpL:perpR;\n    a.desiredForce=s.maxForce;\n    a.desiredScan=80;\n    if(enemy){\n      var aimE=Math.abs(angDiff(myA,enemy.angleFromRobot));\n      if(aimE<0.3&&(m.t-m.lf)>=30){a.desiredLaunch=true;m.lf=m.t;}\n    }\n  }\n}\n// PRIORITY 2: Engage enemy robot\nelse if(enemy){\n  var range=enemy.range;\n  a.desiredScan=clamp(range*0.85,60,400);\n\n  // Predictive aiming\n  var projSpeed=55;\n  var tFlight=range/projSpeed;\n  var evx=enemy.speed*Math.cos(enemy.angle);\n  var evy=enemy.speed*Math.sin(enemy.angle);\n  var predX=enemy.x+evx*tFlight;\n  var predY=enemy.y+evy*tFlight;\n  var leadAngle=angTo(myX,myY,predX,predY);\n\n  a.desiredAngle=leadAngle;\n\n  var aimErr=Math.abs(angDiff(myA,leadAngle));\n  var tgtWidth=Math.atan2(30,range);\n  var sinceFire=m.t-m.lf;\n\n  if(aimErr<tgtWidth*1.2&&sinceFire>=30){\n    a.desiredLaunch=true;\n    m.lf=m.t;\n    m.ev=-m.ev;\n  }\n\n  // Range management + health-aware aggression\n  var healthPct=s.health;\n  if(range<120||healthPct<25){\n    a.desiredForce=-s.maxForce*0.4;\n  }else if(range>280){\n    a.desiredForce=s.maxForce*0.7;\n  }else{\n    if(sinceFire>5&&sinceFire<25){\n      a.desiredAngle=leadAngle+m.ev*0.18;\n      a.desiredForce=s.maxForce*0.45;\n    }else{\n      a.desiredForce=s.maxForce*0.25;\n    }\n  }\n}\n// PRIORITY 3: Seek enemies\nelse{\n  a.desiredScan=100;\n  if(m.t%40<20){m.sw=1;}else{m.sw=-1;}\n  if(dCenter>250){\n    a.desiredAngle=toCenter+m.sw*0.3;\n    a.desiredForce=s.maxForce*0.6;\n  }else if(dCenter>100){\n    a.desiredAngle=toCenter+m.sw*0.5;\n    a.desiredForce=s.maxForce*0.3;\n  }else{\n    a.desiredAngle=myA+m.sw*0.08;\n    a.desiredForce=s.maxForce*0.15;\n  }\n}\n\n// OVERRIDE: Wall avoidance\nif(prox&&prox.entityType==='wall'&&prox.range<35){\n  a.desiredAngle=toCenter;\n  a.desiredForce=s.maxForce*0.8;\n}\nif(myX<60||myX>840||myY<60||myY>840){\n  a.desiredAngle=toCenter;\n  a.desiredForce=s.maxForce;\n}",
    "version": 1,
    "updated": "2026-02-27T00:00:00.000Z",
    "oldBrains": []
}